<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Measurement Sheet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <style>
    body {
      background-color: #f8f9fa;
    }
    .form-section {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .table-section {
      margin-top: 20px;
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    .btn-group {
      margin-top: 15px;
    }
    .form-label {
      font-weight: 500;
    }
    th, td {
      vertical-align: middle !important;
    }
  </style>
</head>
<body>
  <div class="container-fluid mt-4">
    <div class="row">
      <!-- Form Section -->
      <div class="col-md-4">
        <div class="form-section">
          <h5 class="mb-3">Duct Entry</h5>
          <form id="ductForm">
            <div class="mb-2">
              <label class="form-label">Type</label>
              <select class="form-select" id="type" required>
                <option value="">Select</option>
                <option value="ST">ST</option>
                <option value="RED">RED</option>
                <option value="OFFSET">OFFSET</option>
                <option value="DUM">DUM</option>
                <option value="SHOE">SHOE</option>
                <option value="ELB">ELB</option>
                <option value="VANES">VANES</option>
              </select>
            </div>
            <div class="row">
              <div class="col mb-2">
                <label class="form-label">W1</label>
                <input type="number" class="form-control" id="w1" required />
              </div>
              <div class="col mb-2">
                <label class="form-label">H1</label>
                <input type="number" class="form-control" id="h1" required />
              </div>
            </div>

            <div class="row">
              <div class="col mb-2">
                <label class="form-label">W2</label>
                <input type="number" class="form-control" id="w2" />
              </div>
              <div class="col mb-2">
                <label class="form-label">H2</label>
                <input type="number" class="form-control" id="h2" />
              </div>
            </div>
            <div class="row">
              <div class="col mb-2">
                <label class="form-label">Length (mm)</label>
                <input type="number" class="form-control" id="length" required />
              </div>
              <div class="col mb-2">
                <label class="form-label">Quantity</label>
                <input type="number" class="form-control" id="qty" required />
              </div>
            </div>
            <div class="mb-2">
              <label class="form-label">Degree</label>
              <input type="number" class="form-control" id="degree" />
            </div>
            <div class="mb-2">
              <label class="form-label">Factor</label>
              <input type="number" step="0.01" class="form-control" id="factor" value="1" />
            </div>
            <div class="btn-group w-100">
              <button type="button" class="btn btn-primary w-100" onclick="addEntry()">Add Entry</button>
            </div>
          </form>
        </div>
        <!-- Export and Action Buttons -->
        <div class="btn-group w-100 mt-3">
          <button class="btn btn-success me-1" onclick="exportToExcel()">Export to Excel</button>
          <button class="btn btn-danger me-1" onclick="exportToPDF()">Export to PDF</button>
          <button class="btn btn-secondary me-1" onclick="window.print()">Print</button>
          <button class="btn btn-dark" onclick="submitData()">Submit</button>
        </div>
      </div>

      <!-- Table Section -->
      <div class="col-md-8">
        <div class="table-section">
          <h5 class="mb-3">Measurement Sheet</h5>
          <div class="table-responsive">
            <table class="table table-bordered table-striped" id="entryTable">
              <thead class="table-dark text-center">
                <tr>
                  <th>#</th>
                  <th>Type</th>
                  <th>W1</th>
                  <th>H1</th>
                  <th>W2</th>
                  <th>H2</th>
                  <th>Len</th>
                  <th>Qty</th>
                  <th>Deg</th>
                  <th>Factor</th>
                  <th>Gauge</th>
                  <th>Area</th>
                  <th>24g</th>
                  <th>22g</th>
                  <th>20g</th>
                  <th>18g</th>
                  <th>Bolts</th>
                  <th>Cleat</th>
                  <th>Gasket</th>
                  <th>Corner</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="entryBody" class="text-center">
                <!-- Entries will be added here -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal fade" id="editModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <form id="editForm">
          <div class="modal-header">
            <h5 class="modal-title">Edit Entry</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body row g-2">
            <input type="hidden" id="editIndex" />
            <div class="col-6">
              <label class="form-label">Duct Type</label>
              <input type="text" class="form-control" id="editDuctType" required />
            </div>
            <div class="col-6">
              <label class="form-label">W1</label>
              <input type="number" class="form-control" id="editW1" />
            </div>
            <div class="col-6">
              <label class="form-label">H1</label>
              <input type="number" class="form-control" id="editH1" />
            </div>
            <div class="col-6">
              <label class="form-label">W2</label>
              <input type="number" class="form-control" id="editW2" />
            </div>
            <div class="col-6">
              <label class="form-label">H2</label>
              <input type="number" class="form-control" id="editH2" />
            </div>
            <div class="col-6">
              <label class="form-label">Length</label>
              <input type="number" class="form-control" id="editLength" />
            </div>
            <div class="col-6">
              <label class="form-label">Quantity</label>
              <input type="number" class="form-control" id="editQuantity" />
            </div>
            <div class="col-6">
              <label class="form-label">Degree</label>
              <input type="number" class="form-control" id="editDegree" />
            </div>
            <div class="col-6">
              <label class="form-label">Factor</label>
              <input type="number" class="form-control" id="editFactor" />
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-success">Save Changes</button>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    const getGauge = (w1, h1) => {
      if (w1 <= 751 && h1 <= 751) {
        return '24g';
      } else if (w1 <= 1201 && h1 <= 1201) {
        return '22g';
      } else if (w1 <= 1800 && h1 <= 1800) {
        return '20g';
      } else {
        return '18g';
      }
    };

    const formatNumber = (num) => Math.round(num * 100) / 100;

    const calculateMaterials = (type, w1, h1, w2, h2, len, qty, degree, factor, gauge) => {
      let area = 0;
      if (type === "ST") {
        area = 2 * ((w1 + h1) / 1000) * (len / 1000);
      } else if (type === "RED") {
        area = ((w1 + h1 + w2 + h2) / 2000) * (len / 1000) * 2;
      } else if (type === "DUM") {
        area = ((w1 + h1) / 1000) ** 2;
      } else if (type === "OFFSET") {
        area = ((w1 + h1 + w2 + h2) / 2000) * (len / 1000);
      } else if (type === "SHOE" || type === "VANES") {
        area = ((w1 + h1) / 1000) * (len / 1000);
      } else if (type === "ELB") {
        area = (Math.PI * degree * ((w1 + h1) / 1000)) / 360;
      }

      const totalArea = area * qty;

      const nutsAndBolts = qty * 4;
      const cleatFactor = gauge === '24g' ? 0.07 : gauge === '22g' ? 0.08 : gauge === '20g' ? 0.09 : 0.1;
      const cleat = qty * cleatFactor;
      const gasket = ((w1 + h1 + w2 + h2) / 1000) * qty;
      const corner = type === "DUM" ? 0 : qty * 8;

      const areaByGauge = {
        '24g': gauge === '24g' ? totalArea : 0,
        '22g': gauge === '22g' ? totalArea : 0,
        '20g': gauge === '20g' ? totalArea : 0,
        '18g': gauge === '18g' ? totalArea : 0
      };

      return {
        area: formatNumber(totalArea),
        nutsAndBolts,
        cleat: formatNumber(cleat),
        gasket: formatNumber(gasket),
        corner,
        gauge,
        ...areaByGauge
      };
    };

    const updateTable = () => {
      const tbody = document.querySelector("#measurementTable tbody");
      tbody.innerHTML = "";
      entries.forEach((entry, index) => {
        const row = document.createElement("tr");

        row.innerHTML = `
          <td>${entry.type}</td>
          <td>${entry.w1}</td>
          <td>${entry.h1}</td>
          <td>${entry.w2}</td>
          <td>${entry.h2}</td>
          <td>${entry.len}</td>
          <td>${entry.qty}</td>
          <td>${entry.degree}</td>
          <td>${entry.factor}</td>
          <td>${entry.gauge}</td>
          <td>${entry.area}</td>
          <td>${entry['24g']}</td>
          <td>${entry['22g']}</td>
          <td>${entry['20g']}</td>
          <td>${entry['18g']}</td>
          <td>${entry.nutsAndBolts}</td>
          <td>${entry.cleat}</td>
          <td>${entry.gasket}</td>
          <td>${entry.corner}</td>
          <td>
            <button class="btn btn-sm btn-info" onclick="editEntry(${index})">Edit</button>
            <button class="btn btn-sm btn-danger" onclick="deleteEntry(${index})">Delete</button>
          </td>
        `;
        tbody.appendChild(row);
      });
    };

    const editEntry = (index) => {
      const entry = entries[index];
      document.getElementById("type").value = entry.type;
      document.getElementById("w1").value = entry.w1;
      document.getElementById("h1").value = entry.h1;
      document.getElementById("w2").value = entry.w2;
      document.getElementById("h2").value = entry.h2;
      document.getElementById("length").value = entry.len;
      document.getElementById("quantity").value = entry.qty;
      document.getElementById("degree").value = entry.degree;
      document.getElementById("factor").value = entry.factor;

      editingIndex = index;
      document.getElementById("addEntryBtn").textContent = "Update Entry";
    };

    const deleteEntry = (index) => {
      if (confirm("Are you sure you want to delete this entry?")) {
        entries.splice(index, 1);
        updateTable();
        updateTotals();
      }
    };

    const exportToExcel = () => {
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.table_to_sheet(document.getElementById('measurementTable'));
      XLSX.utils.book_append_sheet(wb, ws, 'Sheet1');
      XLSX.writeFile(wb, 'measurement_sheet.xlsx');
    };

    const exportToPDF = () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('l', 'pt', 'a4');
      doc.autoTable({ html: '#measurementTable' });
      doc.save('measurement_sheet.pdf');
    };

    const printTable = () => {
      const printContents = document.getElementById("measurementTable").outerHTML;
      const originalContents = document.body.innerHTML;
      document.body.innerHTML = printContents;
      window.print();
      document.body.innerHTML = originalContents;
      location.reload();
    };

    const submitData = () => {
      console.log("Submitted entries:", entries);
      alert("Data submitted successfully!");
    };

    <script>
  let entries = [];
  let editingIndex = -1;

  function addEntry() {
    const type = document.getElementById("type").value;
    const w1 = +document.getElementById("w1").value;
    const h1 = +document.getElementById("h1").value;
    const w2 = +document.getElementById("w2").value || 0;
    const h2 = +document.getElementById("h2").value || 0;
    const len = +document.getElementById("length").value;
    const qty = +document.getElementById("quantity").value;
    const degree = +document.getElementById("degree").value || 0;
    const factor = +document.getElementById("factor").value || 1;

    const gauge = getGauge(w1, h1);
    const material = calculateMaterials(type, w1, h1, w2, h2, len, qty, degree, factor, gauge);

    const entry = {
      type,
      w1,
      h1,
      w2,
      h2,
      len,
      qty,
      degree,
      factor,
      gauge: material.gauge,
      area: material.area,
      '24g': material['24g'],
      '22g': material['22g'],
      '20g': material['20g'],
      '18g': material['18g'],
      nutsAndBolts: material.nutsAndBolts,
      cleat: material.cleat,
      gasket: material.gasket,
      corner: material.corner
    };

    if (editingIndex >= 0) {
      entries[editingIndex] = entry;
      editingIndex = -1;
      document.getElementById("addEntryBtn").textContent = "Add Entry";
    } else {
      entries.push(entry);
    }

    updateTable();
    document.getElementById("ductForm").reset();
  }
</script>
  </script>
</body>
</html>

      

            

                  

            
