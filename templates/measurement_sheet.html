<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Duct Measurement Sheet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    .form-section {
      background: #f9f9f9;
      border-radius: 10px;
      padding: 20px;
    }
    .table-section {
      background: #ffffff;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      overflow-x: auto;
    }
    .total-footer td {
      font-weight: bold;
      background-color: #e6e6e6;
    }
  </style>
</head>

  <body>
  <div class="container mt-4">
    <div class="row">
      <!-- Left Side Form -->
      <div class="col-md-4">
        <div class="form-section">
          <h4 class="mb-3">Duct Entry Form</h4>
          <form id="entryForm">
            <div class="mb-2"><label>Duct No</label><input type="text" class="form-control" id="ductNo" required /></div>
            <div class="mb-2"><label>Duct Type</label>
              <select class="form-control" id="ductType" required>
                <option value="ST">ST</option>
                <option value="RED">RED</option>
                <option value="DUM">DUM</option>
                <option value="OFFSET">OFFSET</option>
                <option value="SHOE">SHOE</option>
                <option value="VANES">VANES</option>
                <option value="ELB">ELB</option>
              </select>
            </div>
            <div class="mb-2"><label>W1</label><input type="number" class="form-control" id="w1" required /></div>
            <div class="mb-2"><label>H1</label><input type="number" class="form-control" id="h1" required /></div>
            <div class="mb-2"><label>W2</label><input type="number" class="form-control" id="w2" required /></div>
            <div class="mb-2"><label>H2</label><input type="number" class="form-control" id="h2" required /></div>
            <div class="mb-2"><label>Length</label><input type="number" class="form-control" id="length" required /></div>
            <div class="mb-2"><label>Quantity</label><input type="number" class="form-control" id="quantity" required /></div>
            <div class="mb-2"><label>Degree</label><input type="number" class="form-control" id="degree" value="0" /></div>
            <div class="mb-2"><label>Factor</label><input type="number" class="form-control" id="factor" value="1" /></div>
            <button type="button" class="btn btn-primary w-100" onclick="addEntry()">Add Entry</button>
          </form>
        </div>
      </div>

      <!-- Right Side Table -->
      <div class="col-md-8">
        <div class="table-section">
          <h4 class="mb-3">Measurement Sheet</h4>
          <table class="table table-bordered" id="entryTable">
            <thead class="table-dark">
              <tr>
                <th>Duct No</th>
                <th>Type</th>
                <th>W1</th>
                <th>H1</th>
                <th>W2</th>
                <th>H2</th>
                <th>Length</th>
                <th>Qty</th>
                <th>Deg</th>
                <th>Factor</th>
                <th>Gauge</th>
                <th>Area</th>
                <th>Nuts/Bolts</th>
                <th>Cleat</th>
                <th>Gasket</th>
                <th>Corner</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="entryBody"></tbody>
            <tfoot>
              <tr class="table-info fw-bold">
                <td colspan="11" class="text-end">Total Area (mÂ²)</td>
                <td id="totalArea">0</td>
                <td colspan="4"></td>
              </tr>
              <tr class="table-info fw-bold">
                <td colspan="11" class="text-end">Total 24g</td>
                <td id="total24g">0</td><td colspan="4"></td>
              </tr>
              <tr class="table-info fw-bold">
                <td colspan="11" class="text-end">Total 22g</td>
                <td id="total22g">0</td><td colspan="4"></td>
              </tr>
              <tr class="table-info fw-bold">
                <td colspan="11" class="text-end">Total 20g</td>
                <td id="total20g">0</td><td colspan="4"></td>
              </tr>
              <tr class="table-info fw-bold">
                <td colspan="11" class="text-end">Total 18g</td>
                <td id="total18g">0</td><td colspan="4"></td>
              </tr>
            </tfoot>
          </table>

          <div class="mt-3 d-flex justify-content-between">
            <button class="btn btn-success" onclick="exportToExcel()">Export</button>
            <button class="btn btn-warning" onclick="window.print()">Print</button>
            <button class="btn btn-danger" onclick="resetTable()">Reset</button>
          </div>
        </div>
      </div>
    </div>
  </div>

    <script>
  let ductCount = 1;

  function addEntry() {
    const type = document.getElementById("type").value;
    const w1 = parseFloat(document.getElementById("w1").value) || 0;
    const h1 = parseFloat(document.getElementById("h1").value) || 0;
    const w2 = parseFloat(document.getElementById("w2").value) || 0;
    const h2 = parseFloat(document.getElementById("h2").value) || 0;
    const length = parseFloat(document.getElementById("length").value) || 0;
    const qty = parseInt(document.getElementById("qty").value) || 1;
    const degree = parseFloat(document.getElementById("degree").value) || 0;
    const factor = parseFloat(document.getElementById("factor").value) || 1;

    // Gauge Logic
    let gauge = '18g';
    if (w1 <= 751 && h1 <= 751) gauge = '24g';
    else if (w1 <= 1201 && h1 <= 1201) gauge = '22g';
    else if (w1 <= 1800 && h1 <= 1800) gauge = '20g';

    // Area Logic
    let area = 0;
    if (type === 'ST') {
      area = 2 * (w1 + h1) / 1000 * (length / 1000) * qty;
    } else if (type === 'RED') {
      area = (w1 + h1 + w2 + h2) / 1000 * (length / 1000) * qty * factor;
    } else if (type === 'DUM') {
      area = (w1 * h1) / 1_000_000 * qty;
    } else if (type === 'OFFSET') {
      area = (w1 + h1 + w2 + h2) / 1000 * ((length + degree) / 1000) * qty * factor;
    } else if (type === 'SHOE') {
      area = (w1 + h1) * 2 / 1000 * (length / 1000) * qty * factor;
    } else if (type === 'VANES') {
      area = w1 / 1000 * (2 * Math.PI * (w1 / 1000) / 4) * qty;
    } else if (type === 'ELB') {
      area = 2 * (w1 + h1) / 1000 * ((h1 / 2 / 1000) + (length / 1000) * (Math.PI * degree / 180)) * qty * factor;
    }

    const nuts = qty * 4;
    const cleat = qty * (gauge === '24g' ? 4 : gauge === '22g' ? 8 : gauge === '20g' ? 10 : 12);
    const gasket = (w1 + h1 + w2 + h2) / 1000 * qty;
    const corner = type === 'DUM' ? 0 : qty * 8;

    const tableBody = document.getElementById("entryBody");
    const row = document.createElement("tr");

    row.innerHTML = `
      <td>${ductCount++}</td>
      <td>${type}</td>
      <td>${w1}</td>
      <td>${h1}</td>
      <td>${w2}</td>
      <td>${h2}</td>
      <td>${length}</td>
      <td>${qty}</td>
      <td>${degree}</td>
      <td>${factor}</td>
      <td>${gauge}</td>
      <td>${area.toFixed(2)}</td>
      <td>${nuts}</td>
      <td>${cleat}</td>
      <td>${gasket.toFixed(2)}</td>
      <td>${corner}</td>
      <td><button class="btn btn-sm btn-danger" onclick="this.closest('tr').remove(); updateTotals()">X</button></td>
    `;

    tableBody.appendChild(row);
    updateTotals();
  }

  function updateTotals() {
    const rows = document.querySelectorAll("#entryBody tr");
    let total = 0;
    let total24g = 0, total22g = 0, total20g = 0, total18g = 0;

    rows.forEach(row => {
      const area = parseFloat(row.children[11].innerText) || 0;
      const gauge = row.children[10].innerText;
      total += area;
      if (gauge === "24g") total24g += area;
      else if (gauge === "22g") total22g += area;
      else if (gauge === "20g") total20g += area;
      else if (gauge === "18g") total18g += area;
    });

    document.getElementById("totalArea").innerText = total.toFixed(2);
    document.getElementById("total24g").innerText = total24g.toFixed(2);
    document.getElementById("total22g").innerText = total22g.toFixed(2);
    document.getElementById("total20g").innerText = total20g.toFixed(2);
    document.getElementById("total18g").innerText = total18g.toFixed(2);
  }

  function exportToExcel() {
    let table = document.getElementById("entryTable").outerHTML;
    let dataType = 'application/vnd.ms-excel';
    let blob = new Blob(['\ufeff', table], { type: dataType });

    let link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "Measurement_Sheet.xls";
    link.click();
  }

  function resetTable() {
    document.getElementById("entryBody").innerHTML = "";
    updateTotals();
    ductCount = 1;
  }
        </script>


    </tbody>
        <tfoot>
          <tr class="fw-bold">
            <td colspan="11" class="text-end">Total Area</td>
            <td id="totalArea">0.00</td>
            <td colspan="5"></td>
          </tr>
          <tr class="fw-bold">
            <td colspan="11" class="text-end">Total 24g</td>
            <td id="total24g">0.00</td>
            <td colspan="5"></td>
          </tr>
          <tr class="fw-bold">
            <td colspan="11" class="text-end">Total 22g</td>
            <td id="total22g">0.00</td>
            <td colspan="5"></td>
          </tr>
          <tr class="fw-bold">
            <td colspan="11" class="text-end">Total 20g</td>
            <td id="total20g">0.00</td>
            <td colspan="5"></td>
          </tr>
          <tr class="fw-bold">
            <td colspan="11" class="text-end">Total 18g</td>
            <td id="total18g">0.00</td>
            <td colspan="5"></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>

</body>
</html>

      

  
