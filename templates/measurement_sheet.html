<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Measurement Sheet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- SheetJS for Excel Export -->
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

  <style>
    body {
      background: #f3f3f3;
    }
    .form-section {
      background: #ffffff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
    }
    .table-section {
      background: #ffffff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      overflow-x: auto;
    }
    .table th, .table td {
      white-space: nowrap;
    }
    .btn-action {
      margin-right: 10px;
    }
  </style>
</head>

  <body>
<div class="container-fluid mt-3">
  <div class="row">
    
    <!-- LEFT: Input Form -->
    <div class="col-md-4 form-section">
      <h5 class="mb-3">Add Measurement Entry</h5>
      
      <div class="mb-2"><label>Type</label>
        <select class="form-select" id="type">
          <option value="ST">ST</option>
          <option value="RED">RED</option>
          <option value="DUM">DUM</option>
          <option value="OFFSET">OFFSET</option>
          <option value="SHOE">SHOE</option>
          <option value="VANES">VANES</option>
          <option value="ELB">ELB</option>
        </select>
      </div>
      
      <div class="mb-2"><label>W1</label><input type="number" id="w1" class="form-control"></div>
      <div class="mb-2"><label>H1</label><input type="number" id="h1" class="form-control"></div>
      <div class="mb-2"><label>W2</label><input type="number" id="w2" class="form-control"></div>
      <div class="mb-2"><label>H2</label><input type="number" id="h2" class="form-control"></div>
      <div class="mb-2"><label>Length</label><input type="number" id="length" class="form-control"></div>
      <div class="mb-2"><label>Degree</label><input type="number" id="degree" class="form-control"></div>
      <div class="mb-2"><label>Quantity</label><input type="number" id="qty" class="form-control" value="1"></div>
      <div class="mb-2"><label>Factor</label><input type="number" id="factor" class="form-control" value="1"></div>
      
      <div class="mb-2"><strong>Calculated Area:</strong> <span id="areaValue">0</span> m²</div>
      
      <button class="btn btn-primary w-100" onclick="addEntry()">Add Entry</button>
    </div>

    <!-- RIGHT: Table Section -->
    <div class="col-md-8 table-section">
      <h5 class="mb-3">Measurement Entries</h5>
      <div class="table-responsive">
        <table class="table table-bordered" id="entryTable">
          <thead class="table-light">
            <tr>
              <th>Type</th>
              <th>W1</th><th>H1</th><th>W2</th><th>H2</th>
              <th>Length</th><th>Degree</th><th>Qty</th><th>Factor</th>
              <th>Gauge</th><th>Area (m²)</th>
              <th>24g</th><th>22g</th><th>20g</th><th>18g</th>
              <th>Nuts</th><th>Cleat</th><th>Gasket</th><th>Corner</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="entryBody"></tbody>
        </table>
      </div>
      
      <!-- Buttons -->
      <div class="mt-3 d-flex">
        <button onclick="exportToExcel()" class="btn btn-success btn-action">Export Excel</button>
        <button onclick="window.print()" class="btn btn-secondary btn-action">Print</button>
        <button onclick="submitData()" class="btn btn-primary">Submit</button>
      </div>
    </div>
  </div>
</div>
<script>
  function addEntry() {
    const duct_type = document.getElementById("type").value;
    const width1 = parseFloat(document.getElementById("w1").value) || 0;
    const height1 = parseFloat(document.getElementById("h1").value) || 0;
    const width2 = parseFloat(document.getElementById("w2").value) || 0;
    const height2 = parseFloat(document.getElementById("h2").value) || 0;
    const length = parseFloat(document.getElementById("length").value) || 0;
    const degree = parseFloat(document.getElementById("degree").value) || 0;
    const quantity = parseInt(document.getElementById("qty").value) || 1;
    const factor = parseFloat(document.getElementById("factor").value) || 1;

    let gauge = '18g';
    if (0 <= width1 && width1 <= 751 && 0 <= height1 && height1 <= 751) gauge = '24g';
    else if (751 < width1 && width1 <= 1201 && 751 < height1 && height1 <= 1201) gauge = '22g';
    else if (1201 < width1 && width1 <= 1800 && 1201 < height1 && height1 <= 1800) gauge = '20g';
    else if (width1 > 1800 && height1 > 1800) gauge = '18g';

    let area = 0;
    if (duct_type === 'ST') {
      area = 2 * (width1 + height1) / 1000 * (length / 1000) * quantity;
    } else if (duct_type === 'RED') {
      area = (width1 + height1 + width2 + height2) / 1000 * (length / 1000) * quantity * factor;
    } else if (duct_type === 'DUM') {
      area = (width1 * height1) / 1_000_000 * quantity;
    } else if (duct_type === 'OFFSET') {
      area = (width1 + height1 + width2 + height2) / 1000 * ((length + degree) / 1000) * quantity * factor;
    } else if (duct_type === 'SHOE') {
      area = (width1 + height1) * 2 / 1000 * (length / 1000) * quantity * factor;
    } else if (duct_type === 'VANES') {
      area = width1 / 1000 * (2 * 3.14 * (width1 / 1000) / 4) * quantity;
    } else if (duct_type === 'ELB') {
      area = 2 * (width1 + height1) / 1000 * ((height1 / 2 / 1000) + (length / 1000) * (3.14 * (degree / 180))) * quantity * factor;
    }

    let nuts = quantity * 4;
    let cleat = quantity * (gauge === '24g' ? 4 : gauge === '22g' ? 8 : gauge === '20g' ? 10 : 12);
    let gasket = (width1 + height1 + width2 + height2) / 1000 * quantity;
    let corner = (duct_type === 'DUM') ? 0 : quantity * 8;

    document.getElementById("areaValue").innerText = area.toFixed(3);

    const row = `
      <tr>
        <td>${duct_type}</td>
        <td>${width1}</td><td>${height1}</td><td>${width2}</td><td>${height2}</td>
        <td>${length}</td><td>${degree}</td><td>${quantity}</td><td>${factor}</td>
        <td>${gauge}</td><td>${area.toFixed(3)}</td>
        <td>${gauge === '24g' ? area.toFixed(3) : ''}</td>
        <td>${gauge === '22g' ? area.toFixed(3) : ''}</td>
        <td>${gauge === '20g' ? area.toFixed(3) : ''}</td>
        <td>${gauge === '18g' ? area.toFixed(3) : ''}</td>
        <td>${nuts}</td><td>${cleat}</td><td>${gasket.toFixed(2)}</td><td>${corner}</td>
        <td><button class="btn btn-sm btn-danger" onclick="this.closest('tr').remove()">Delete</button></td>
      </tr>
    `;
    document.getElementById("entryBody").insertAdjacentHTML('beforeend', row);
  }

  function exportToExcel() {
    let table = document.getElementById("entryTable").outerHTML;
    let dataUri = 'data:application/vnd.ms-excel,' + encodeURIComponent(table);
    let link = document.createElement('a');
    link.href = dataUri;
    link.download = 'measurement_sheet.xls';
    link.click();
  }

  function submitData() {
    alert("Data submitted (simulate)");
  }
             </script>

    <div class="mt-3 d-flex gap-2">
      <button onclick="exportToExcel()" class="btn btn-success">Export to Excel</button>
      <button onclick="submitData()" class="btn btn-primary">Submit</button>
      <button onclick="window.print()" class="btn btn-secondary">Print</button>
    </div>
  </div> <!-- close container -->
  
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
    

  
